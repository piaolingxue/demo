<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Invoice</title>
  </head>

  <body><h1>Invoice</h1><table border="1" cellspacing="0" id="invoice-table"
      width="90%">
      <col />

      <col />

      <col width="4*" />

      <thead>
        <tr bgcolor="#B0C4DE">
          <th>Qty</th>

          <th>Product</th>

          <th>Description</th>

          <th>Unit Price</th>

          <th>TOTAL</th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td align="center">2</td>

          <td>xe-1u</td>

          <td><?xxe-formula formula='location = ((&#34;spreadsheet-demo/products.xhtml#&#34; &#38; trim($[+0,-1])) &#38; &#34;_desc&#34;)
=`document($location, .)`'?>XMLmind XML Editor - Single User License</td>

          <td align="right">$200.00</td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=($[+0,-4] * numbervalue($[+0,-1], &#34;$#,##0.00&#34;))'
format='${#,##0.00}'?>$400.00</td>
        </tr>

        <tr>
          <td align="center">1</td>

          <td>xe-5u</td>

          <td><?xxe-formula formula='location = ((&#34;spreadsheet-demo/products.xhtml#&#34; &#38; trim($[+0,-1])) &#38; &#34;_desc&#34;)
=`document($location, .)`'?>XMLmind XML Editor - 5-user Pack License</td>

          <td align="right">$800.00</td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=($[+0,-4] * numbervalue($[+0,-1], &#34;$#,##0.00&#34;))'
format='${#,##0.00}'?>$800.00</td>
        </tr>

        <tr>
          <td align="center">1</td>

          <td>fc-uu</td>

          <td><?xxe-formula formula='location = ((&#34;spreadsheet-demo/products.xhtml#&#34; &#38; trim($[+0,-1])) &#38; &#34;_desc&#34;)
=`document($location, .)`'?>XMLmind XSL-FO Converter - Unrestricted Use
          License</td>

          <td align="right">$3,000.00</td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=($[+0,-4] * numbervalue($[+0,-1], &#34;$#,##0.00&#34;))'
format='${#,##0.00}'?>$3,000.00</td>
        </tr>

        <tr>
          <td align="center">1</td>

          <td>sc-cs</td>

          <td><?xxe-formula formula='location = ((&#34;spreadsheet-demo/products.xhtml#&#34; &#38; trim($[+0,-1])) &#38; &#34;_desc&#34;)
=`document($location, .)`'?>XMLmind Spell-Checker - Client/Server License</td>

          <td align="right">$100.00</td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=($[+0,-4] * numbervalue($[+0,-1], &#34;$#,##0.00&#34;))'
format='${#,##0.00}'?>$100.00</td>
        </tr>

        <tr>
          <td align="right" colspan="4"><b>SubTotal</b></td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=sum(apply(&#39;numbervalue(x, &#34;$#,##0.00&#34;)&#39;, difference($[,+0], $[+0,+0]:$[+994,+0])))'
format='${#,##0.00}'?>$4,300.00</td>
        </tr>

        <tr>
          <td align="right" colspan="3"><b>VAT</b></td>

          <td align="right" id="VAT">19.6%</td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=rounddown((numbervalue($[-1,+0], &#34;$#,##0.00&#34;) * (left($[+0,-1], (len($[+0,-1]) - 1)))%), 2)'
format='${#,##0.00}'?>$842.80</td>
        </tr>

        <tr>
          <td align="right" colspan="4"><b>TOTAL</b></td>

          <td align="right" bgcolor="#FFE4B5"><?xxe-formula formula='=(numbervalue($[-2,+0], &#34;$#,##0.00&#34;) + numbervalue($[-1,+0], &#34;$#,##0.00&#34;))'
format='${#,##0.00}'?>$5,142.80</td>
        </tr>
      </tbody>
    </table><p>The VAT rate <span><?xxe-formula formula='=$(VAT)'?>19.6%</span>
  is the VAT rate of France.</p><h1>What to do with this
  demo?</h1><blockquote><p><b>Note:</b> the integrated spreadsheet engine is a
  feature available only in XMLmind XML Editor Professional Edition, where it
  is <em>hidden</em> by default. You need to enable it by checking "<b>Enable
  the Integrated Spreadsheet Engine</b>" in <b>Options</b>|<b>Preferences</b>,
  <b>Features</b> section.</p></blockquote><ul>
      <li>Change quantity, product reference (available products are found in
      <a
      href="spreadsheet-demo/products.xhtml">spreadsheet-demo/products.xhtml</a>),
      unit price or VAT rate, then click in (or tab to) another cell to see
      how the spreadsheet is updated.</li>

      <li>Copy/paste a product row and modify any of the above cells in the
      new row.</li>

      <li>Delete a product row.</li>

      <li>Double-click on the little <tt>f</tt> icon to display the formula
      editor. (<tt>f</tt> icons are found before text generated by spreadsheet
      calculations.)</li>

      <li>Change the <tt>xml:lang</tt> attribute of the <tt>html</tt> root
      element from "<tt>en</tt>" to "<tt>fr</tt>". Then undo the spreadsheet
      calculation and also undo the attribute change.</li>

      <li>More information in <a href="../doc/spreadsheet/index.html">XMLmind
      XML Editor - Using the Integrated Spreadsheet Engine</a>.</li>
    </ul></body>
</html>
